import Callout from 'nextra-theme-docs/callout'

# 入门

<Callout>
  在学习 redi 的使用方法前，建议先了解依赖注入模式的一些基本概念
</Callout>

## 安装

在项目目录执行如下的命令：

```shell
yarn add @wendellhu/redi
```

或者使用 npm 等你喜欢的包管理器：

```shell
npm install @wendellhu/redi
```

安装之后，你需要在 tsconfig.json 文件中启用 `experimentalDecorators` 。

```json highlight=3
{
  "compilerOptions": {
    "experimentalDecorators": true
  }
}
```

## 基本使用

让我们来看这样的一个例子：

```tsx
class AuthService {
  public static getCurrentUserInfo(): UserInfo {
    // your implementation here...
  }
}

class FileListService {
  constructor() {}

  public getUserFiles(): Promise<Files> {
    const currentUser = AuthService.getCurrentUserInfo()
    // ...
  }
}
```

显然，FileListService 依赖于 AuthService，让我们一起来看看如何使用依赖注入模式改造这段代码。

**第一步：声明依赖关系**

```typescript highlight=1,4,10,13
import { Inject } from '@wendellhu/redi'

class AuthService {
    public getCurrentUserInfo(): UserInfo {
        // your implementation here...
    }
}

class FileListService {
   constructor(@Inject(AuthService) private readonly authService: AuthService) {}

    public getUserFiles(): Promise<Files> {
       const currentUser = this.authService.getCurrentUserInfo()
        // ...
    }
}
```

使用 Inject 装饰器，在 FileListService 的构造函数上，将 AuthService 声明为它的一个依赖。

**第二步：提供依赖**

```typescript
import { Injector } from '@wendellhu/redi'


const injector = new Injector([[FileListService], [AuthService]])
```

只需要将依赖项添加到 Injector 对象中。

**第三步：完成！**

```typescript
const fileListService = injector.get(FileListService)
```

这样你就获得了 `FileListService` 的一个实例！而且它的依赖 `AuthService` 已经被创建好了，缓存在 `Injector` 当中。

```typescript
const authService = injector.get(FileListService)
```
